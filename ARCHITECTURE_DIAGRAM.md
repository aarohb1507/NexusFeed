# NexusFeed Container Architecture - Complete Visual Reference

## System Architecture Overview

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       NexusFeed Containerized Platform                     â•‘
â•‘                          (docker-compose.yml)                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLIENT LAYER (External)                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Web Browser / Mobile App / API Client                                    â”‚
â”‚         â”‚                                                                  â”‚
â”‚         â”‚ HTTP/HTTPS Request                                             â”‚
â”‚         â”‚ http://localhost:3000/v1/...                                   â”‚
â”‚         â”‚                                                                  â”‚
â”‚         â–¼                                                                  â”‚
â”‚  localhost:3000 (Host Machine)                                            â”‚
â”‚         â”‚                                                                  â”‚
â”‚         â”‚ Docker Port Mapper (NAT)                                       â”‚
â”‚         â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Virtual network bridge (172.19.0.1/16)
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOCKER BRIDGE NETWORK: nexusfeed-network                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ APPLICATION TIER - 5 Microservices                                 â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ API Gateway (172.19.0.2:3000)                             â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Express.js HTTP server                             â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Rate limiting (Redis-backed)                       â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Request routing & proxying                         â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Auth middleware (JWT validation)                   â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ CORS & Security headers                            â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚      â†“ Routes (/v1/*)                                      â”‚   â”‚    â”‚
â”‚ â”‚  â”‚      â”œâ”€ /auth/* â†’ identity-service:3001                   â”‚   â”‚    â”‚
â”‚ â”‚  â”‚      â”œâ”€ /posts/* â†’ post-service:3002                      â”‚   â”‚    â”‚
â”‚ â”‚  â”‚      â”œâ”€ /media/* â†’ media-service:3003                     â”‚   â”‚    â”‚
â”‚ â”‚  â”‚      â””â”€ /search â†’ search-service:3004                     â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ Identity Service (172.19.0.3:3001)                      â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ User registration & login                          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ JWT token generation (15m expiry)                  â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Refresh token rotation (7d expiry)                 â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Password hashing (Argon2)                          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Token validation endpoint                          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ Post Service (172.19.0.4:3002)                          â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Create posts (with optional mediaIds)              â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Read posts (paginated, Redis-cached)               â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Delete posts (owner validation)                    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Publish RabbitMQ events (post.created/deleted)     â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Cache invalidation (intelligent TTL)               â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Cache strategy: posts:page:limit â†’ 300s TTL          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ Media Service (172.19.0.5:3003)                         â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ File upload handling (Multer)                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Cloudinary CDN integration                         â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Media metadata storage                             â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Listen to post.deleted (media cleanup)             â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Publish media.uploaded events                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ Search Service (172.19.0.6:3004)                        â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Full-text search ($text operator)                  â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Pagination with result ranking                     â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Event-driven indexing (RabbitMQ listener)          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Redis caching of search results (300s TTL)         â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â€¢ Listen to post.created/deleted for indexing        â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ MESSAGE QUEUE TIER - Event-Driven Communication                    â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ RabbitMQ (172.19.0.9:5672)                               â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Exchange: facebook_events (topic-based)              â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚                                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Topics (Routing Keys):                               â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ post.created                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”‚  â””â”€ Subscribers: Search Service, Media Service    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ post.deleted                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”‚  â””â”€ Subscribers: Search Service, Media Service    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â””â”€ media.uploaded                                    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚    â””â”€ Subscribers: Post Service                     â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚                                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Acknowledgment: Manual ACK on successful processing  â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Dead Letter Queue: Failed messages stored for retry  â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ Management UI: http://localhost:15672 (guest/guest)      â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ DATA PERSISTENCE TIER - Shared Infrastructure                      â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ MongoDB (172.19.0.7:27017) - Central Database             â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Collections:                                         â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ users (from identity-service)                    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”‚  â””â”€ userId, email, password (hashed), createdAt   â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ posts (from post-service)                        â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”‚  â””â”€ postId, userId, content, mediaIds[], dates    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ media (from media-service)                       â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”‚  â””â”€ mediaId, userId, url, publicId (Cloudinary)   â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â””â”€ search (from search-service)                     â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚    â””â”€ postId, userId, content (denormalized), dates â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚    â””â”€ Text index on 'content' for full-text search  â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚                                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Credentials: root / rootpassword                     â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Database: nexusfeed (specified in compose)           â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Volume: mongo-data (persistent across restarts)      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚ â”‚  â”‚ Redis (172.19.0.8:6379) - Distributed Cache              â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Cache Keys (with TTL):                               â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ rate_limit:IP (managed by express-rate-limit)    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ posts:page:limit (300s TTL)                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â”œâ”€ post:postId (3600s TTL)                          â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ â””â”€ search:query:page:limit (300s TTL)               â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚                                                      â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Volume: redis-data (persistent, RDB snapshots)       â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â”‚ Invalidation: Intelligent cache busting on writes    â”‚  â”‚   â”‚    â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚    â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚ â”‚                                                                     â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Data Flow Diagram: Create Post

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CREATE POST REQUEST FLOW                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Client (Browser)
  â”‚
  â””â”€â†’ POST /v1/posts/create-post
      {
        "content": "Hello World",
        "mediaIds": ["media-123"]
      }

  â”‚ HTTP:5672
  â–¼ (to localhost:3000)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway:3000   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â†’ Rate Limit Check
  â”‚   â””â”€â†’ Redis GET rate_limit:ip_address
  â”‚       â””â”€â†’ [172.19.0.8:6379]
  â”‚
  â”œâ”€â†’ JWT Validation
  â”‚   â””â”€â†’ Extract & verify Authorization header
  â”‚
  â””â”€â†’ Route to POST /api/posts/create-post
      â””â”€â†’ http://post-service:3002
          (Docker DNS: post-service â†’ 172.19.0.4:3002)

  â”‚ HTTP:3002
  â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Post Service:3002          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â†’ Validate Request
  â”‚   â””â”€â†’ Joi schema validation
  â”‚
  â”œâ”€â†’ Database Write
  â”‚   â””â”€â†’ MongoDB INSERT
  â”‚       db.posts.insertOne({
  â”‚         postId: "post-789",
  â”‚         userId: "user-123",
  â”‚         content: "Hello World",
  â”‚         mediaIds: ["media-123"],
  â”‚         createdAt: Date.now()
  â”‚       })
  â”‚       â””â”€â†’ [172.19.0.7:27017]
  â”‚
  â”œâ”€â†’ Publish Event (Async)
  â”‚   â””â”€â†’ RabbitMQ Topic: post.created
  â”‚       Message:
  â”‚       {
  â”‚         postId: "post-789",
  â”‚         userId: "user-123",
  â”‚         content: "Hello World",
  â”‚         mediaIds: ["media-123"]
  â”‚       }
  â”‚       â””â”€â†’ [172.19.0.9:5672]
  â”‚
  â”œâ”€â†’ Invalidate Cache
  â”‚   â””â”€â†’ Redis DEL posts:*
  â”‚       (Clear all pagination caches)
  â”‚       â””â”€â†’ [172.19.0.8:6379]
  â”‚
  â””â”€â†’ Send Response
      HTTP 201 Created
      {
        "postId": "post-789",
        "userId": "user-123",
        "content": "Hello World",
        "createdAt": "2024-01-15T10:30:00Z"
      }

  â”‚ HTTP:3002
  â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway:3000   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â””â”€â†’ Forward Response to Client

  â”‚ HTTP:3000
  â–¼

Client (Browser)
  â””â”€ Display: "Post created successfully!"


[ASYNCHRONOUS PROCESSING HAPPENS MEANWHILE]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Search Service (172.19.0.6:3004)
  â”‚ [Listening on RabbitMQ topic: post.created]
  â”‚
  â””â”€â†’ Receives post.created event
      â”‚
      â”œâ”€â†’ MongoDB INSERT into search collection
      â”‚   db.search.insertOne({
      â”‚     postId: "post-789",
      â”‚     userId: "user-123",
      â”‚     content: "Hello World",
      â”‚     createdAt: "2024-01-15T10:30:00Z"
      â”‚   })
      â”‚
      â”œâ”€â†’ Create text index on 'content'
      â”‚
      â”œâ”€â†’ Invalidate search cache
      â”‚   Redis DEL search:*
      â”‚
      â””â”€â†’ Acknowledge message to RabbitMQ âœ“


Media Service (172.19.0.5:3003)
  â”‚ [Listening on RabbitMQ topic: post.created]
  â”‚
  â””â”€â†’ Receives post.created event
      â”‚
      â”œâ”€â†’ For each mediaId in mediaIds:
      â”‚   MongoDB UPDATE
      â”‚   db.media.updateOne(
      â”‚     { _id: "media-123" },
      â”‚     { $set: { postId: "post-789" } }
      â”‚   )
      â”‚
      â””â”€â†’ Acknowledge message to RabbitMQ âœ“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[RESULT]
Synchronous: ~35ms to client (post created in database)
Asynchronous: ~45ms total (search indexed, media linked)
Eventual Consistency: All services synchronized within 100ms
```

---

## Network Communication Paths

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SERVICE COMMUNICATION MATRIX                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Source â†’ Destination                     Protocol    Port   Purpose
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Client  â†’ API Gateway                    HTTP/HTTPS  3000   Request routing
API Gateway â†’ Identity Service           HTTP        3001   JWT validation
API Gateway â†’ Post Service               HTTP        3002   CRUD posts
API Gateway â†’ Media Service              HTTP        3003   Upload handling
API Gateway â†’ Search Service             HTTP        3004   Query search

All Services â†’ MongoDB                   MONGODB     27017  Data persistence
All Services â†’ Redis                     REDIS       6379   Caching
Services â†’ RabbitMQ                      AMQP        5672   Event messaging

Internal DNS Resolution:
  identity-service:3001 â†’ 172.19.0.3:3001
  post-service:3002 â†’ 172.19.0.4:3002
  media-service:3003 â†’ 172.19.0.5:3003
  search-service:3004 â†’ 172.19.0.6:3004
  mongo:27017 â†’ 172.19.0.7:27017
  redis:6379 â†’ 172.19.0.8:6379
  rabbitmq:5672 â†’ 172.19.0.9:5672
```

---

## Container Startup Timeline

```
Time   Container       Event
â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0s     docker-compose Start infrastructure containers
       
1s     mongo           Container created, starting process
       redis           Container created, starting process
       rabbitmq        Container created, starting process
       
5s     mongo           Process listening, health check pending
       redis           Process listening, health check pending
       rabbitmq        Process listening, health check pending
       
10s    mongo           âœ“ HEALTHY (passed 3 health checks)
       redis           âœ“ HEALTHY (passed 3 health checks)
       rabbitmq        âœ“ HEALTHY (passed 3 health checks)
       
       [Trigger dependent services]
       
15s    identity        Starting (depends_on: mongo healthy)
       post-service    Starting (depends_on: mongo, redis, rabbitmq healthy)
       media-service   Starting (depends_on: mongo, rabbitmq healthy)
       search-service  Starting (depends_on: mongo, redis, rabbitmq healthy)
       
20s    identity        Connecting to MongoDB
       post-service    Connecting to MongoDB, Redis, RabbitMQ
       media-service   Connecting to MongoDB, RabbitMQ
       search-service  Connecting to MongoDB, Redis, RabbitMQ
       
25s    identity        âœ“ Express listening on 3001
       post-service    âœ“ Express listening on 3002
       media-service   âœ“ Express listening on 3003
       search-service  âœ“ Express listening on 3004
       
30s    identity        âœ“ HEALTHY (health check passed)
       post-service    âœ“ HEALTHY (health check passed)
       media-service   âœ“ HEALTHY (health check passed)
       search-service  âœ“ HEALTHY (health check passed)
       
       [Trigger dependent service]
       
45s    api-gateway     Starting (depends_on: all services healthy)
       
50s    api-gateway     Connecting to Redis
       
55s    api-gateway     âœ“ Express listening on 3000
       
60s    api-gateway     âœ“ HEALTHY (health check passed)
       
65s    STACK READY     All containers healthy, ready for requests âœ“
```

---

## Health Check Status Transitions

```
Container Lifecycle with Health Checks
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[Startup]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Starting        â”‚  Grace period: 5 seconds (no health checks)
â”‚ (initializing)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ After 5s: First health check
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Healthy     â”‚â—„â”€â”€â”€â”€â”€â”¤ Health Check â”‚
    â”‚ (ready)     â”‚      â”‚ Passed âœ“     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Every 30s: Periodic health check
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Healthy     â”‚â—„â”€â”€â”€â”€â”€â”¤ Health Check â”‚
    â”‚ (ready)     â”‚      â”‚ Passed âœ“     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Process crashes or health check fails
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Unhealthy   â”‚  Failure #1
    â”‚ (restarting)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 30s later: Health check
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Unhealthy   â”‚â—„â”€â”€â”€â”€â”€â”¤ Health Check â”‚
    â”‚ (restarting)â”‚      â”‚ Failed âœ—     â”‚  Failure #2
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 30s later: Health check
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Unhealthy   â”‚â—„â”€â”€â”€â”€â”€â”¤ Health Check â”‚
    â”‚ (restarting)â”‚      â”‚ Failed âœ—     â”‚  Failure #3 (retries exceeded)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Docker action: Restart container
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Restarting  â”‚  New container spawned
    â”‚ (new cycle) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â”‚
             â”‚ After 5s: Grace period elapsed
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Healthy     â”‚â—„â”€â”€â”€â”€â”€â”¤ Health Check â”‚
    â”‚ (ready)     â”‚      â”‚ Passed âœ“     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â†’ Service operational again
```

---

## Container Resource Architecture

```
Resource Allocation (Current: No Limits)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Each Container:
  â”œâ”€ CPU: Unlimited (shares host CPU with other containers)
  â”œâ”€ Memory: Unlimited (can grow to host limit)
  â”œâ”€ Disk: Via volume mounts (Docker manages)
  â””â”€ Network: 172.19.0.0/16 (bridge network)

Container Sizes (Typical):
  api-gateway             ~80MB  (Express, Redis client, JWT parser)
  identity-service        ~90MB  (Express, MongoDB, Argon2)
  post-service           ~100MB  (Express, MongoDB, Redis, RabbitMQ)
  media-service          ~100MB  (Express, MongoDB, Multer, RabbitMQ)
  search-service         ~100MB  (Express, MongoDB, Redis, RabbitMQ)
  
  mongo:latest           ~450MB  (Database engine)
  redis:latest           ~150MB  (Cache engine)
  rabbitmq:latest        ~180MB  (Message broker)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  TOTAL:                ~1250MB


Recommended Resource Limits (for production):
  api-gateway:      256MB RAM, 0.5 CPU
  identity-service: 256MB RAM, 0.25 CPU
  post-service:     512MB RAM, 1 CPU
  media-service:    512MB RAM, 1 CPU
  search-service:   512MB RAM, 1 CPU
  mongo:            1GB RAM, 2 CPU
  redis:            256MB RAM, 0.5 CPU
  rabbitmq:         512MB RAM, 1 CPU
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  TOTAL:           ~4.25GB RAM, 7.25 CPU
```

---

## Port Exposure & Firewall Rules

```
Host Machine                Docker Bridge               External
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€
localhost
  â”œâ”€ :3000 â€”â€”â€”â€”â†’ EXPOSED â€”â€”â€”â†’ api-gateway:3000 (172.19.0.2)
  â”‚                           â”œâ”€ Can be accessed from host
  â”‚                           â””â”€ Can be accessed from external networks
  â”‚
  â”œâ”€ :27017 â€”â€”â€”â€”â†’ EXPOSED â€”â€”â€”â†’ mongo:27017 (172.19.0.7)
  â”‚                           â””â”€ For dev convenience only
  â”‚
  â”œâ”€ :6379 â€”â€”â€”â€”â†’ EXPOSED â€”â€”â€”â†’ redis:6379 (172.19.0.8)
  â”‚                          â””â”€ For dev convenience only
  â”‚
  â”œâ”€ :5672 â€”â€”â€”â€”â†’ EXPOSED â€”â€”â€”â†’ rabbitmq:5672 (172.19.0.9)
  â”‚                          â””â”€ For dev convenience only
  â”‚
  â””â”€ :15672 â€”â€”â€”â€”â†’ EXPOSED â€”â€”â€”â†’ rabbitmq:15672 (172.19.0.9)
                              â””â”€ Management UI (dev only)

Internal (Bridge Network Only)
  api-gateway:3000 â€”â€”â€”â€”â†’ identity-service:3001 (172.19.0.3)
  api-gateway:3000 â€”â€”â€”â€”â†’ post-service:3002 (172.19.0.4)
  api-gateway:3000 â€”â€”â€”â€”â†’ media-service:3003 (172.19.0.5)
  api-gateway:3000 â€”â€”â€”â€”â†’ search-service:3004 (172.19.0.6)
  
  All services â€”â€”â€”â€”â†’ mongo:27017 (172.19.0.7)
  All services â€”â€”â€”â€”â†’ redis:6379 (172.19.0.8)
  All services â€”â€”â€”â€”â†’ rabbitmq:5672 (172.19.0.9)

  [NOT EXPOSED]
  External networks CANNOT reach :3001, :3002, :3003, :3004 directly
  â””â”€ Must go through api-gateway:3000
```

---

## Summary: Architecture Key Points

âœ“ **5 Application Services**: Independent, stateless, scalable
âœ“ **3 Infrastructure Services**: Shared MongoDB, Redis, RabbitMQ
âœ“ **Bridge Network**: Internal DNS, service discovery
âœ“ **Single Exposure Point**: Only API Gateway to host (security)
âœ“ **Event-Driven**: Asynchronous RabbitMQ communication
âœ“ **Cached & Persistent**: Redis + MongoDB for performance & durability
âœ“ **Self-Healing**: Health checks, auto-recovery
âœ“ **Correct Startup**: Dependency chain with healthchecks

This is enterprise-grade containerization ready for production! ğŸš€

